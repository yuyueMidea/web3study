一些概念
- blockchain， 底层的区块链网络，一个DeFi应用一般会部署到多个不同的区块链网络
- smart contract，智能合约，是DiFi应用的核心业务实现；
- price Oracle：价格预言机，用来提供价格信息的，一般分为链下预言机和链上预言机，一般是后端服务；
- keeper service：一般是后端服务，智能合约的任务触发器和执行器，因为智能合约本身没有自动触发执行任务的能力，所以需要外部的任务触发器协助；
- subgraph:子图，也被称为索引器，主要是将链上数据重新组装成方便前端查询的数据，也可以用后端服务实现；
- graph node：subgraph锁运行的环境，会同步链上区块数据给Subgraph 处理；
- Wallet：钱包应用，最主流的是MetaMask；
- WebUI：前端展示的UI界面，一般用vue，react等框架；
- SDK：封装了对Subgraph 的查询、智能合约的调用、钱包的连接，方便前端UI的调用；


为什么需要后端代码在区块链中？
- 数据存储与管理查询；
- 与传统系统的集成；
- 与区块链交互；
- 定时任务；
- 消息队列；


用Go语言调用智能合约，做成Restful API接口；智能合约的调用是实现一个DApp的关键，一个完整的DApp包括前端、后端、智能合约及区块链系统；智能合约的调用是连接区块链与前后端的关键；

智能合约运行在以太坊节点的EVM中；想要调用合约必须先访问某个节点；后端服务连接节点有两种方式：一种是双方在同一个主机，此时后端连接节点可以采用本地IPC(Inter-Process Communication，进程间通信)机制，也可以采用 RPC(Remote Procedure Call，远程过程调用)机制；另一种情况是双方不再同一个主机，此时只能通过rpc通信；

智能合约运行的过程：是后端服务连接某个节点，将智能合约的调用（交易）发送给某节点，节点在验证了交易合法性以后，进行全网广播，被矿工打包到区块中代表此交易得到了确认，至此交易算完成； 智能合约被调用的两个关键点是节点和SDK；由于IPC要求后端与节点必须在同一个主机，所以很多时候开发者都采用了RPC模式；
